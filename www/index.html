<!DOCTYPE html>
<!--
    Copyright (c) 2012-2016 Adobe Systems Incorporated. All rights reserved.

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>

   
<head>
   <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, minimal-ui" />
  
   <!-- <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' gap:; style-src 'self' 'unsafe-inline'; media-src *" />-->

    
    
    
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
   <!-- <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *" />
    <!-- Good default declaration:
    * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
    * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
    * Disables use of eval() and inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
        * Enable inline JS: add 'unsafe-inline' to default-src
        * Enable eval(): add 'unsafe-eval' to default-src
    * Create your own at http://cspisawesome.com
    -->
<!--<meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: 'unsafe-inline' https://ssl.gstatic.com; style-src 'self' 'unsafe-inline'; media-src *" />
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' gap:; style-src 'self' 'unsafe-inline'; media-src *" />
-->

   <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' data: gap: https://ssl.gstatic.com 'unsafe-eval' *.firebaseapp.com https://*.firebaseio.com wss://*.firebaseio.com blob: data:; style-src 'self' 'unsafe-inline'; media-src *">


    <title>Date or Duck</title>

     <link rel="stylesheet" href="css/framework7.css">
      <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/pe-7s.css">
    <link rel="stylesheet" href="css/pe-7f.css">
    <link rel="stylesheet" href="css/helper.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/twemoji.css">
    </head>

<body>

   
<div class="statusbar-overlay" style="background-color:#2196f3"></div>
 
<div class="panel-overlay"></div>
 
<div class="panel panel-left panel-reveal">

<div id="view-2" class="view tab">
 
<div class="navbar" style="background-color:#2196f3;color:white;">
    <div class="navbar-inner">
        <div class="left"></div>
        <div class="center left-title">Calendar</div>
        
        <div class="right" ></div>
            
            

    

            
    </div>
</div>
<div class="pages navbar-through">
<div data-page="index-2" class="page">
<div class="page-content" style="padding-top:20px;background-color:#f7f7f8;">






<div class="timeline-upcoming timeline-date timeline">


    
</div>


</div>
</div>
</div>
<!--
<div class="toolbar" style="background-color:#2196f3;">
          <div class="toolbar-inner" style="padding:0px;">

            
            <a href="#" onclick="preferencesPopup();" style="color:white;width:50%;float:width;text-align:center;">Preferences</a>
            <a href="#" class="close-panel" onclick="logout()" style="background-color:#ff3b30;color:white;width:50%;height:44px;float:width;text-align:center;"><div style="margin-top:10px;">Logout</div></a>
          </div>
        </div>
-->
</div>





</div>
 
 
 
 
<div class="panel panel-right panel-reveal" style="background-color:#efeff4;">

<div id="view-2" class="view tab">
 
<div class="navbar" style="background-color:#2196f3;color:white;">
    <div class="navbar-inner">
        <div class="left"></div>
        <div class="center right-title">Matches</div>
        
        <div class="right" ></div>

    </div>
</div>
<div class="pages navbar-through">
<div data-page="index-2" class="page">
<div class="page-content pull-to-refresh-content pull-to-refresh-content-2"    style="background-color:#f7f7f8;margin-bottom:-44px;" onscroll="scrollNotifications();">

<div class="pull-to-refresh-layer">
      <div class="preloader"></div>
      <div class="pull-to-refresh-arrow"></div>
    </div>
<!--
<div class="list-block" style="margin-top:0px;">
  <ul>
  
  


        <li class="upgradeli" style="display:none;padding:20px;font-size:14px;background-color:black;color:white;text-align:center;"> <i class="twa twa-3x twa-eyes" style="margin:0 auto;"></i><p> Get notified when someone is interested in you. <br/><a href="#" class="button" style="margin-top:10px;color:white;background-color:#2196f3;">Sign up for Premium </a></p></li>



    
    </ul>
    </div>
-->
    
   
<div class="list-block virtual-list media-list virtual-notifications"  style="margin-top:0px;margin-bottom:0px;">
  <!-- keep it empty -->
</div>

<div id="notiflistdiv"></div>

</div>
</div>
</div>
<!--
<div class="toolbar" style="background-color:#2196f3;">
          <div class="toolbar-inner" style="padding:0px;">

            
            <a href="#" onclick="preferencesPopup();" style="color:white;width:50%;float:width;text-align:center;">Preferences</a>
            <a href="#" class="close-panel" onclick="logout()" style="background-color:#ff3b30;color:white;width:50%;height:44px;float:width;text-align:center;"><div style="margin-top:10px;">Logout</div></a>
          </div>
        </div>
-->
</div>









</div>
 

 
<div class="views tabs toolbar-through">
 

 
<div id="view-1" class="view view-main tab active">
 


 
 <div class="itim ploader" style="z-index:9999999;width: 100%;height: 100%;position: absolute;top: 0;left: 0;background-color:#2196f3;">
         
         <div style="width:200px;height:210px;position:absolute;top:50%;left:50%;margin-left:-100px;margin-top:-130px;text-align:center;color:white;">
  
  <img class="desktopimage" src="media/dateorducklogo.png" style="margin: 0 auto;width:120px;clear:both;"><br/>

<span style="font-family: 'Pacifico', cursive;font-size:26px;font-weight:100;color:white;clear:both;">Date or Duck</span>
		 <p> Meeting people, made easy.</p>
		 <div class="dateduckdesktop"></div>

 <div class="unknownerror" style="display:none;">
             
                 <h2>An error occured</h2>
                 
                                  <p class="errorarea" style="font-size:12px;padding-left:10px;padding-right:10px;"></p>

                 
             <a href="#" onclick="startApp()" class="button" >Try Again</a>
            
             </div>
                 
             <div class="permissiondenied" style="display:none;">
             
                 
                 <h2>Location Access Required</h2>
                 
                 <p style="font-size:12px;padding-left:10px;padding-right:10px;">You denied our request for your location. To access this app, you must change your privacy settings. Then re-start the app.</p>

                 
             </div>
             
<a href="#" class="button-big button loginbutton mainlogin" onclick="newLogin()" style="border-color:white;display:none;margin-top:10px;margin-left:10px;background-color:white;color:#2196f3;">Login</a>
<a href="#" class="button secondlogin" onclick="login()" style="border-color:white;display:none;color:white;margin-top:10px;margin-left:10px;background-color:transparent;">Login new user</a>

             <p class="loginbutton button-big" style="clear:both;display:none;color:white;"> <a href="#" style="color:white;font-size:12px;clear:both;" onclick="hidePloader();">Terms and Conditions of Use</a> <span style="color:white;"><br/></span> <a href="#" style="color:white;font-size:12px;" onclick="hidePloader(1);">Privacy Policy</a></p>        

             <!--
             <p class="loginbutton" style="font-size:12px;display:none;padding-left:10px;padding-right:10px;">This is because You need a Facebook account to login (to keep profile photos decent).</p>
 -->
             

             <span class="preloader preloader-white login-loader" style="margin-top:20px;clear:both;"></span>






           

     
 </div>

      
      </div>

 <div class="navbar navbar-home" style="background-color:#2196f3;">
 <div class="navbar-inner" style="padding:0px;">
     <!--
    <a href="#" onclick="setWant(0)" class="homedate button link" style="overflow:visible;border-radius:50%;border:1px solid white;font-family: 'Pacifico', cursive;font-size:24px;width:50%;border-radius:20px;top:0%;height:36px;margin-top:-4px;"><span style="border-radius:5px;left:50%;position:absolute;margin-right: 20px;margin-left:-32px;margin-top:-4px;">Date</span>         <div style="width:30px;overflow-x:hidden;position:absolute;top:-3px;right:0px;"></div> </a>
     <a href="#" class="link" style="font-family: 'Pacifico', cursive;text-align:center;height:44px;width:44px;border-radius:50%;border:1px solid white;">Or</a> 
     <a href="#" onclick="setWant(1)" class="homeduck button link" style="overflow:visible;border-radius:50%;top:0%;margin-top:-4px;border-radius:20px;font-family: 'Pacifico', cursive;font-size:24px;height:36px;top:0%;width:50%;border:1px solid white;"><span style="border-radius:5px;left:50%;position:absolute;margin-left:-32px;margin-top:-5px;">Duck</span>   <div style="width:30px;overflow-x:hidden;position:absolute;top:-3px;left:0;"></div></a>
    
    
    -->

    <a href="#" onclick="setWant(0)" class="homedate button link" style="width:50%;overflow:visible;border-radius:50%;border:1px solid white;border-right:0;font-family: 'Pacifico', cursive;font-size:24px;border-radius:20px;top:0%;height:44px;border-top-right-radius:0px;border-bottom-right-radius:0px;border-radius:0px;border:0;"><span class="datetext" style="border-radius:5px;left:50%;position:absolute;margin-right: 20px;margin-left:-32px;margin-top:0px;">Date</span> <span class="preloader preloader-white datenavloader" style="display:none;width:27px;margin:0 auto;"></span> <div style="width:30px;overflow-x:hidden;position:absolute;top:4px;right:0px;"><img src="media/datefaceonly.png" style="width:40px;margin-left:9px;" class="datenavpic"></div> </a>
	 <a href="#" onclick="setWant(1)" class="homeduck button link" style="width:50%;overflow:visible;border-radius:50%;top:0%;border-radius:20px;font-family: 'Pacifico', cursive;font-size:24px;height:44px;top:0%;border:1px solid white;border-left:0;border-top-left-radius:0px;border-bottom-left-radius:0px;border-radius:0px;border:0;"><span class="ducktext" style="border-radius:5px;left:50%;position:absolute;margin-left:-15px;margin-top:0px;">Duck</span>  <span class="preloader preloader-white ducknavloader" style="display:none;width:27px;margin:0 auto;"></span> <div style="width:30px;overflow-x:hidden;position:absolute;top:4px;left:0;"> <img src="media/duckfaceonly.png" style="width:40px;margin-left:-27px;" class="ducknavpic"></div></a>

      
    </div>
</div>

<div class="pages navbar-through" style="background-color:white;">
 
<div data-page="index-1" class="page" style="background-color:white;">
   <div style="width:100%;text-align:center;z-index:909999999999999;margin-top:0px;height:44px;background-color:#ccc;position:absolute;top:0px;">
          <div class="preloader" style="margin: 0 auto;margin-top:10px;"></div>
				</div>

	
<div class="content-here-2">
<div class="page-content page-content-2 pull-to-refresh-content pull-to-refresh-content-1 pagepullmarker" data-ptr-distance="55" style="background-color:white;height:100%;">

<div class="pull-to-refresh-layer" style="margin-top:-44px;background-color:transparent;">
      <div class="preloader"></div>
      <div class="pull-to-refresh-arrow"></div>
    </div>
 
	
	
<div class="content-here" style="z-index:10000;background-color:#f7f7f8;height: calc(100% - 88px);width:100%;top:44px;position:absolute;overflow:hidden;">
 <div class="no-results-div" style="background-color:white;text-align:center;padding-top:88px;">
    
    <img src="media/datetongue.png" style="width:120px;margin:0 auto;">
    
   <div><h3>No one found nearby</h3><p style="padding-top:0px;margin-top:-10px;">Try changing your search radius </br> or age range.</p></br></div>


   
    </div>
	
	</div>


    

	

	
	
<div class="content-block-title home-title" style="margin:15px;display:none;">Randomly ordered</div>
<!-- Slider container -->
<div class="swiper-container swiper-random">
    <!-- Slides wrapper -->
    <div class="swiper-wrapper random-wrapper">


    </div>
</div>
<div class="content-block-title home-title nearby-title" style="overflow:visible;margin:15px;display:none;margin-top:20px;"><i class="pe-7s-lock pe-lg"></i> Nearby First (Locked)</div>
<!-- Slider container --> 

	<div style="background-color:white;width:100%;text-align:left;z-index:9999;padding-top:10px;padding-bottom:10px;display:none;margin-top:5px;" class="nearby-helper">

<span class="preloader nearby-loader" style="width:42px;height:42px;display:none;"></span>


    </div>
	
	<div class="swiper-container swiper-nearby" >
    <!-- Slides wrapper -->
    <div class="swiper-wrapper nearby-wrapper" style="-webkit-filter: blur(10px);z-index:-1;">
        <!-- Slides -->

    </div>
    
</div>



<!-- Slider container -->
<div class="content-block-title home-title recent-title" style="overflow:visible;margin:15px;margin-top:20px;display:none;"><i class="pe-7s-lock pe-lg"></i> Recently Online (Locked)</div>

	<div style="background-color:white;width:100%;text-align:left;z-index:9999;padding-top:10px;padding-bottom:10px;display:none;margin-top:5px;" class="recent-helper">

<span class="preloader recent-loader" style="width:42px;height:42px;display:none;"></span>


    </div>
	
	<div class="swiper-container swiper-recent">
    <!-- Slides wrapper -->
    <div class="swiper-wrapper recent-wrapper" style="-webkit-filter: blur(10px);">
        <!-- Slides -->

    </div>
</div>

		
		
		
		</div>
	</div>


<span class="preloader results-loader" style="width:42px;height:42px;display:none;position:absolute;top:50%;margin-top:-21px;left:50%;margin-left:-21px;"></span>

	<div class="content-here-1">
<div class="page-content page-content-1" style="background-color:white;height:100%;">

	<div class="messages messages1">
 

       
	</div> 
    </div>
</div>
	
<audio controls id="buzzer" style="display:none;">
  <source src="media/quack.mp3" type="audio/mpeg">
</audio>

<!--<a href="#" class="button" onclick="addFakey()">Add Fake User</a>
<a href="#" class="button" onclick="markMe()">Mark Me</a>

<a href="#" class="button" onclick="checkArray()">Check Array</a>
-->







</div>
</div>
</div>
 

<div id="view-3" class="view tab">
<div class="pages">
<div data-page="index-3" class="page">
<div class="page-content">
<div class="content-block-title">3</div>
<div class="content-block">
View 3
</div>
</div>
</div>
</div>
</div>
<div id="view-4" class="view tab">
<div class="pages navbar-fixed">
<div data-page="index-4" class="page">
<div class="navbar">
<div class="navbar-inner">
<div class="center">Settings</div>
</div>
</div>
<div class="page-content">
<div class="content-block-title">4</div>
<div class="content-block">
View 4
</div>
<div class="content-block">
<p>Mauris commodo lacus at nisl lacinia, nec facilisis erat rhoncus. Sed eget pharetra nunc. Aenean vitae vehicula massa, sed sagittis ante. Quisque luctus nec velit dictum convallis. Nulla facilisi. Ut sed erat nisi. Donec non dolor massa. Mauris malesuada dolor velit, in suscipit leo consectetur vitae. Duis tempus ligula non eros pretium condimentum. Cras sed dolor odio.</p>
</div>
</div>
</div>
</div>
</div>


 

                


<!-- 

<img src="media/bluebackground.png" style="position:absolute;bottom:-10px;left:50%;margin-left:-55px;z-index:10000;width:110px;">
<a href="#tab3" class="tab-link" >
            <div style="width:50px;overflow-x:hidden;position:absolute;right:0;margin-top:-8px;border-right:1px solid #2196f3;"><img src="media/datefaceonly.png" style="width:100px;"></div>

        </a>
         <a href="#tab3" class="tab-link" >
            <div style="width:50px;overflow-x:hidden;position:absolute;left:0;margin-top:-8px;border-left:1px solid #2196f3;"> <img src="media/duckfaceonly.png" style="width:100px;margin-left:-50px;"></div>

        </a>
            
     <a href="#tab1" class="tab-link">
            <i class="pe-7s-clock pe-lg" style="font-size:28px;margin-top:5px;"></i>
<span class="tabbar-label">Recent</span>
        </a>
        <a href="#tab1" class="tab-link">
            <i class="pe-7s-shuffle pe-lg" style="font-size:28px;margin-top:5px;"></i>
             <span class="tabbar-label">Shuffle</span>

        </a>
<a href="#tab1" class="tab-link" onclick="getPhotoPermissionNow();">
            <i class="pe-7s-share pe-2x" style="font-size:28px;margin-top:5px;"></i>
        </a>




-->


<div class="toolbar toolbar-home tabbar" style="z-index:5000;background-color:#2196f3;display:none;">
   <div class="toolbar-inner" style="background-color:transparent;">
 
       

 <a href="#tab1" class="tab-link open-panel" data-panel="left">
            <i class="pe-7s-date pe-lg" style="font-size:28px;margin-top:5px;"></i>

        </a>

       <a href="#tab1" class="tab-link" onclick="navPicker();">
            <i class="pe-7s-edit pe-2x" style="font-size:28px;margin-top:5px;"></i>
        </a>
	   

       

<a href="#tab1" class="tab-link open-panel" data-panel="right">
            <i class="pe-7s-like pe-lg" style="font-size:28px;margin-top:5px;"></i>
            <span class="badge notifspan" style="display:none;z-index:9999;position:absolute;margin-top:-7px;left:50%;top:15px;margin-left:5px;background-color:#ffd000;height:12px;width:12px;"></span>

        </a>


  


 </div>
</div>




</div>

<script type="text/javascript" src="js/firebase-app.js"></script>
    <script type="text/javascript" src="js/firebase-auth.js"></script>
    <script type="text/javascript" src="js/firebase-database.js"></script>
    <script type="text/javascript" src="js/firebase-storage.js"></script>

    

<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAgU_QQb-dKUM_iPnHSkA_VycnGIMsnKas",
    authDomain: "single-duck.firebaseapp.com",
    databaseURL: "https://single-duck.firebaseio.com",
    storageBucket: "single-duck.appspot.com",
    messagingSenderId: "124927619672"
  };

  var defaultApp = firebase.initializeApp(config);
  var firebaseRef = firebase.database().ref();

// Get a reference to the storage service, which is used to create references in your storage bucket
var storage = firebase.storage();

// Create a storage reference from our storage service
var storageRef = storage.ref();



var database = firebase.database();
//alert(defaultApp.name);  // "[DEFAULT]"


    
</script>

    <script type="text/javascript" src="cordova.js"></script>
 <script type="text/javascript" src="js/jquery.js"></script>
     <script type="text/javascript" src="js/framework7.js"></script>

    <script type="text/javascript" src="js/app.js"></script>
    
    <script type="text/javascript" src="js/openfb.js"></script>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA8NFfaMkN25u3jgjgZj5Z7BPrmXWQliqM&libraries=places"></script>

    <script type="text/javascript">
        $( document ).ready(function() {
app.initialize();
myApp.swiper('.swiper-helper-info', {
    pagination:'.swiper-pagination'
  });
        }); 

        
    </script>
    <script>

        // Defaults to sessionStorage for storing the Facebook token
    //  Uncomment the line below to store the Facebook token in localStorage instead of sessionStorage
      openFB.init({appId: '784956164912201', tokenStore: window.localStorage});
        

        
        function login() {

            $( ".login-loader" ).show();
		    $( ".secondlogin" ).hide();
            
            $( ".loginbutton" ).hide();
            
            
            
        openFB.login(
                function(response) {
			          

                    if(response.status === 'connected') {

                        //alert('Facebook login succeeded, got access token: ' + response.authResponse.accessToken);
                        f_token = response.authResponse.accessToken;
                        window.localStorage.setItem("tokenStore", response.authResponse.accessToken);
                                                window.localStorage.setItem("loginmethod", "2");

			    
 var f_unix = Math.round(+new Date()/1000);
f_token_expiry = f_unix + 2678400;

			    
 ftokenset = true;
		
		    
		    startApp();

                        
			    
			     openFB.api({
            path: '/me',
            success: function(data) {
                //console.log(JSON.stringify(data));

		    
		    FCMPlugin.subscribeToTopic( data.id, function(msg){
    //alert( msg );
}, function(err){
    myApp.alert('Error', 'Could not register push notifications');
			    
} );
		    
		   
		    
            },
            error: errorHandler});
			    
			    
			  
                        
                    } else {
                      
                        if (response.error ==='undefined') {
			//	myApp.alert('Please login to start', 'Login required');
			}
                       else {
			//       myApp.alert('Facebook login failed: ' + response.error, 'Oops');
		       }
                        
                         
                        $( ".login-loader" ).hide();$( ".loginbutton" ).show(); $( ".secondlogin" ).show();
                    }
                }, {scope: 'email,user_friends,user_photos'});
    }
        
        
        function newLogin(){
        $( ".login-loader" ).show();
		    $( ".secondlogin" ).hide();
            
            $( ".loginbutton" ).hide();
		try {
     var fbLoginSuccess = function (userData) {

         
         if(userData.status === 'connected') {

                        //alert('Facebook login succeeded, got access token: ' + response.authResponse.accessToken);
                        f_token = userData.authResponse.accessToken;
		 
             f_token_expiry = userData.authResponse.expiresIn * 1000;

		 ftokenset = true;
	
		 
		 
		 window.localStorage.setItem("tokenStore", userData.authResponse.accessToken);
                        window.localStorage.setItem("loginmethod", "1");
                        window.localStorage.setItem("tokenStore", userData.authResponse.accessToken);

                        startApp();
                       
FCMPlugin.subscribeToTopic( userData.authResponse.userID, function(msg){
  //alert( msg );
}, function(err){
      myApp.alert('Error', 'Could not register push notifications');

} );
		 
                    } else {
                      
                      //  if (userData.error ==='undefined') {myApp.alert('Please login to start', 'Login required');}
                    //   else {myApp.alert('Facebook login failed: ' + userData.error, 'Oops');}
                        
                          $( ".login-loader" ).hide();$( ".loginbutton" ).show(); $( ".secondlogin" ).show();
                       
                    }
         
         
     };
     facebookConnectPlugin.login(["public_profile","email","user_friends","user_photos"], fbLoginSuccess,
          function loginError (error) {
	     $( ".login-loader" ).hide();$( ".loginbutton" ).show(); $( ".secondlogin" ).show();
               
          }
     );
}
catch (e) {
   //  alert('error1='+e.message);
	$( ".login-loader" ).hide();$( ".loginbutton" ).show(); $( ".secondlogin" ).show();
}
        }
        
    function getInfo() {
        openFB.api({
            path: '/me',
            success: function(data) {
                //console.log(JSON.stringify(data));
                //alert(data.name);
            },
            error: errorHandler});
    }
    function share() {
        openFB.api({
            method: 'POST',
            path: '/me/feed',
            params: {
                message: 'Date or Duck'
            },
            success: function() {
                //alert('the item was posted on Facebook');
            },
            error: errorHandler});
    }

	    
function photoPermissions(){

var userphotospermission = 0;

var loginmethod = window.localStorage.getItem("loginmethod");

    if (loginmethod == '1'){
    
    var cb9 = function (response) {

	     for (i = 0; i < response.data.length; i++) { 

  if (response.data[i].permission == 'user_photos' && response.data[i].status == 'granted'){userphotospermission = 1;}
    }

		    if (userphotospermission === 0){
		    myApp.closeModal('.photopopup');
			  getPhotoPermissionNow(); 
		    
		    }
		    else{loadAlbums();}
		    	    

		    
}
	    	    var cb7 = function (result) {

}
facebookConnectPlugin.api("me/permissions", [], cb9, cb7);
    
    }
	
	else{

	
		     openFB.api({
            method: 'GET',
            path: '/me/permissions',
            success: function(response) {
              
		     for (i = 0; i < response.data.length; i++) { 

  if (response.data[i].permission == 'user_photos' && response.data[i].status == 'granted'){userphotospermission = 1;}
    }

		    if (userphotospermission === 0){
		    myApp.closeModal('.photopopup');
			    getPhotoPermissionNow();
		    
		    }
		    else{loadAlbums();}
		    
		   // alert(JSON.stringify(result.data));
            },
            error: errorHandler
        });	
		
	//else
	}
//function
}	    
	    
	    
	    
	    
	    
	    
	    
	    
	    
	    
	    
	    
	    function readPermissions() {
     
	    
	    
	    
	    var userfriendspermission = 0;

	    
	    
	    

 var loginmethod = window.localStorage.getItem("loginmethod");

    if (loginmethod == '1'){
    
	    var cb = function (response) {

	     for (i = 0; i < response.data.length; i++) { 

  if (response.data[i].permission == 'user_friends' && response.data[i].status == 'granted'){userfriendspermission = 1;}
    }

		    if (userfriendspermission === 0){
		    
			    $('.nearby-helper').html(
		'<div class="list-block media-list" style="margin-top:-20px;margin-bottom:5px;"><ul>'+
     '   <li>'+
          '  <div class="item-content" style="background-color:#f7f7f8;border-radius:5px;margin-left:20px;margin-right:20px;margin-top:10px;">'+
              // ' <div class="item-media">'+
               //    ' <img src="path/to/img.jpg">'+
              // ' </div>'+
                '<div class="item-inner">'+
                    '<div class="item-title-row">'+
                      '  <div class="item-title">Invite friends to use this app</div>'+
                       // '<div class="item-after"></div>'+
                   ' </div>'+
                    '<div class="item-subtitle" style="margin-top:5px;margin-bottom:5px;"><a href="#" class="button active" onclick="getFriends()">Find friends</a></div>'+
                   ' <div class="item-text">Sign up <span class="badge" style="background-color:#ff3b30;color:white;">5</span> friends on Facebook to unlock this feature.</div>'+
                '</div>'+
            '</div>'+
        '</li>'+
    '</ul></div>  ');
	
	$('.recent-helper').html(
		'<div class="list-block media-list" style="margin-top:-20px;margin-bottom:5px;"><ul>'+
     '   <li>'+
          '  <div class="item-content" style="background-color:#f7f7f8;border-radius:5px;margin-left:20px;margin-right:20px;margin-top:10px;">'+
              // ' <div class="item-media">'+
               //    ' <img src="path/to/img.jpg">'+
              // ' </div>'+
                '<div class="item-inner">'+
                    '<div class="item-title-row">'+
                      '  <div class="item-title">Invite friends to use this app</div>'+
                       // '<div class="item-after"></div>'+
                   ' </div>'+
                    '<div class="item-subtitle" style="margin-top:5px;margin-bottom:5px;"><a href="#" class="button active" onclick="getFriends()">Find friends</a></div>'+
                   ' <div class="item-text">Sign up <span class="badge" style="background-color:#ff3b30;color:white;">10</span> friends on Facebook to unlock this feature.</div>'+
                '</div>'+
            '</div>'+
        '</li>'+
    '</ul></div>  ');
		    
		    }
		    else{fQuery();}
		    	    

		    
}
	    	    var cb2 = function (result) {

}
facebookConnectPlugin.api("me/permissions", [], cb, cb2);
    
    
    }
	    else{    
	    
	    
		     openFB.api({
            method: 'GET',
            path: '/me/permissions',
            success: function(response) {
              
		     for (i = 0; i < response.data.length; i++) { 

  if (response.data[i].permission == 'user_friends' && response.data[i].status == 'granted'){userfriendspermission = 1;}
    }

		    if (userfriendspermission === 0){
		    
			    $('.nearby-helper').html(
		'<div class="list-block media-list" style="margin-top:-20px;margin-bottom:5px;"><ul>'+
     '   <li>'+
          '  <div class="item-content" style="background-color:#f7f7f8;border-radius:5px;margin-left:20px;margin-right:20px;margin-top:10px;">'+
              // ' <div class="item-media">'+
               //    ' <img src="path/to/img.jpg">'+
              // ' </div>'+
                '<div class="item-inner">'+
                    '<div class="item-title-row">'+
                      '  <div class="item-title">Invite friends to use this app</div>'+
                       // '<div class="item-after"></div>'+
                   ' </div>'+
                    '<div class="item-subtitle" style="margin-top:5px;margin-bottom:5px;"><a href="#" class="button active" onclick="getFriends()">Find friends</a></div>'+
                   ' <div class="item-text">Sign up <span class="badge" style="background-color:#ff3b30;color:white;">5</span> friends on Facebook to unlock this feature.</div>'+
                '</div>'+
            '</div>'+
        '</li>'+
    '</ul></div>  ');
	
	$('.recent-helper').html(
		'<div class="list-block media-list" style="margin-top:-20px;margin-bottom:5px;"><ul>'+
     '   <li>'+
          '  <div class="item-content" style="background-color:#f7f7f8;border-radius:5px;margin-left:20px;margin-right:20px;margin-top:10px;">'+
              // ' <div class="item-media">'+
               //    ' <img src="path/to/img.jpg">'+
              // ' </div>'+
                '<div class="item-inner">'+
                    '<div class="item-title-row">'+
                      '  <div class="item-title">Invite friends to use this app</div>'+
                       // '<div class="item-after"></div>'+
                   ' </div>'+
                    '<div class="item-subtitle" style="margin-top:5px;margin-bottom:5px;"><a href="#" class="button active" onclick="getFriends()">Find friends</a></div>'+
                   ' <div class="item-text">Sign up <span class="badge" style="background-color:#ff3b30;color:white;">10</span> friends on Facebook to unlock this feature.</div>'+
                '</div>'+
            '</div>'+
        '</li>'+
    '</ul></div>  ');
		    
		    }
		    else{fQuery();}
		    
		   // alert(JSON.stringify(result.data));
            },
            error: errorHandler
        });
}
   
    }    
	    
	    
	    
	    function revoke() {
        openFB.revokePermissions(
                function() {
                    //alert('Permissions revoked');
                },
                errorHandler);
		    
	    }
	    
	   
    
  

        
function getFriends(){

	var loginmethod = window.localStorage.getItem("loginmethod");


    if (loginmethod == '1'){
    
    
     var fbFriendSuccess = function (userData) {
         
         
         if(userData.status === 'connected') {

                        //alert('Facebook login succeeded, got access token: ' + response.authResponse.accessToken);
                        f_token = userData.authResponse.accessToken;
             f_token_expiry = userData.authResponse.expiresIn;
                        window.localStorage.setItem("tokenStore", userData.authResponse.accessToken);
firebase.database().ref('users/' + f_uid).update({
token:userData.authResponse.accessToken
  }).then(function() {});
fQuery();

                        
                    } else {

                       
                    }
         
         
     };
	    
	  facebookConnectPlugin.login(["user_friends"], fbFriendSuccess,
          function loginError (error) {
	    
               //alert('error='+JSON.stringify(error))
          }
     );  
 
    
    }
    else{
    
	    openFB.login(
                function(response) {
                    if(response.status === 'connected') {

              f_token = response.authResponse.accessToken;
                        firebase.database().ref('users/' + f_uid).update({
token:response.authResponse.accessToken
  }).then(function() {});
                        window.localStorage.setItem("tokenStore", response.authResponse.accessToken);

              fQuery();          
                        //update
                        
                    } else {
                      


                    }
                }, {scope: 'user_friends'});
	  
    
    
    }
	
	
	
}

        function getPhotoPermissionNow(){

	var loginmethod = window.localStorage.getItem("loginmethod");


    if (loginmethod == '1'){
    
      var fbPhotoSuccess = function (userData) {
         
         
         if(userData.status === 'connected') {

                        //alert('Facebook login succeeded, got access token: ' + response.authResponse.accessToken);
                        f_token = userData.authResponse.accessToken;
             f_token_expiry = userData.authResponse.expiresIn;
                        window.localStorage.setItem("tokenStore", userData.authResponse.accessToken);
firebase.database().ref('users/' + f_uid).update({
token:userData.authResponse.accessToken
  }).then(function() {});

                        
                    } else {

                       
                    }
         
         
     };
	    
	  facebookConnectPlugin.login(["user_photos"], fbPhotoSuccess,
          function loginError (error) {
	    
               //alert('error='+JSON.stringify(error))
          }
     );  
    
    }
		else{
		
		openFB.login(
                function(response) {
                    if(response.status === 'connected') {

       
                        f_token = response.authResponse.accessToken;
                        window.localStorage.setItem("tokenStore", response.authResponse.accessToken);
                        firebase.database().ref('users/' + f_uid).update({
token:response.authResponse.accessToken
  }).then(function() {});
                        //update

                    } else {
              
                        

                    }
                }, {scope: 'user_photos'});
		}
}

function logout(){
	myApp.confirm('Are you sure?', 'Logout', function () {
      
    FCMPlugin.unsubscribeFromTopic(f_uid);
		cordova.plugins.notification.badge.set(0);
	var loginmethod = window.localStorage.getItem("loginmethod");

    if (loginmethod == '1'){logoutPlugin();}
    else{logoutOpen();}
});
}
        
        function logoutPlugin() {

            facebookConnectPlugin.logout(
function (error) { 

            logoutDo();
                    myFunction();
                   $( ".toolbar" ).hide();// alert('Logout successful');

},
function (error) { 
	//alert(error);
}
);           

    }
    function errorHandler(error) {
        //alert(error.message);
    }
        
         function logoutOpen() {
        openFB.logout(
                function() {
                    logoutDo();
myFunction();
                   $( ".toolbar" ).hide();
                },
                errorHandler);
    }

        function logoutDo(){
        
            firebase.auth().signOut().then(function() {


       //         window.open('https://www.dateorduck.com/clearcookies.php?accesstoken=' + f_token, '_blank', 'location=no,clearcache=yes,toolbar=no');
                
myApp.closeModal();loaded = false; f_token = false;loadpref = false;
        sexuality = false;
                        homewant = false;
		    	    $( ".secondlogin" ).show();
            
            $( ".loginbutton" ).show();
                        $( ".homedate" ).removeClass("active");
                        $( ".homeduck" ).removeClass("active");
radiussize = '100';
radiusunit = 'Kilometres';
industry_u = false;
hometown_u = false;
status_u = false;
politics_u = false;
eyes_u = false;
body_u = false;
religion_u = false;
zodiac_u = false;                        
 ethnicity_u = false;
                        weight_u = false;
                        height_u = false; 
   
availarray = [];
f_description = '';
offsounds = 'N';
f_age = false;
f_interested = false;
f_gender = false;
f_upper = false;
f_lower = false;    f_projectid = false;         
tokenStore = false;storage.removeItem(tokenStore);$( ".toolbar" ).hide();
                       
                        
                        
}, function(error) {
  // An error happened.
});
        
        }
        
</script>
</body>

</html>
